(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[43136],{22122:function(e,n,t){"use strict";function a(){return(a=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e}).apply(this,arguments)}t.d(n,{Z:function(){return a}})},17375:function(e,n,t){"use strict";function a(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}t.d(n,{Z:function(){return a}})},3905:function(e,n,t){"use strict";t.d(n,{Zo:function(){return s},kt:function(){return u}});var a=t(67294);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var c=a.createContext({}),p=function(e){var n=a.useContext(c),t=n;return e&&(t="function"===typeof e?e(n):l(l({},n),e)),t},s=function(e){var n=p(e.components);return a.createElement(c.Provider,{value:n},e.children)},d={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},m=a.forwardRef((function(e,n){var t=e.components,r=e.mdxType,o=e.originalType,c=e.parentName,s=i(e,["components","mdxType","originalType","parentName"]),m=p(t),u=r,k=m["".concat(c,".").concat(u)]||m[u]||d[u]||o;return t?a.createElement(k,l(l({ref:n},s),{},{components:t})):a.createElement(k,l({ref:n},s))}));function u(e,n){var t=arguments,r=n&&n.mdxType;if("string"===typeof e||r){var o=t.length,l=new Array(o);l[0]=m;var i={};for(var c in n)hasOwnProperty.call(n,c)&&(i[c]=n[c]);i.originalType=e,i.mdxType="string"===typeof e?e:r,l[1]=i;for(var p=2;p<o;p++)l[p]=t[p];return a.createElement.apply(null,l)}return a.createElement.apply(null,t)}m.displayName="MDXCreateElement"},96086:function(e){"use strict";var n=Object.assign.bind(Object);e.exports=n,e.exports.default=e.exports},50151:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return d}});var a=t(22122),r=t(17375),o=t(67294),l=t(3905),i=(o.createElement,function(e){return function(n){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),(0,l.kt)("div",n)}}),c=i("Intro"),p=i("CodeTab"),s={};function d(e){var n=e.components,t=(0,r.Z)(e,["components"]);return(0,l.kt)("wrapper",(0,a.Z)({},s,t,{components:n,mdxType:"MDXLayout"}),(0,l.kt)("h1",{id:"beyond-jsx"},"Beyond JSX"),(0,l.kt)(c,{mdxType:"Intro"},(0,l.kt)("p",null,"JSX is a syntax sugar that allows us to use React components in an HTML like manner. A component needs to adhere to certain interface conventions, otherwise it can't be used in JSX. This section will go into detail on how the JSX transformation works and what React APIs are used underneath.")),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"Note:")," This section requires knowledge about the low level apis for ",(0,l.kt)("a",(0,a.Z)({parentName:"p"},{href:"./elements-and-jsx#creating-elements-from-component-functions"}),"creating elements"),", such as ",(0,l.kt)("inlineCode",{parentName:"p"},"React.createElement")," or ",(0,l.kt)("inlineCode",{parentName:"p"},"ReactDOMRe.createDOMElementVariadic"),"."),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},(0,l.kt)("strong",{parentName:"p"},"Note:")," This page assumes your ",(0,l.kt)("inlineCode",{parentName:"p"},"bsconfig.json")," to be set to ",(0,l.kt)("inlineCode",{parentName:"p"},'"reason": { "react-jsx": 3 }')," to apply the right JSX transformations. ")),(0,l.kt)("h2",{id:"component-types"},"Component Types"),(0,l.kt)("p",null,"A plain React component is defined as a ",(0,l.kt)("inlineCode",{parentName:"p"},"('props) => React.element")," function. You can also express a component more efficiently with our shorthand type ",(0,l.kt)("inlineCode",{parentName:"p"},"React.component<'props>"),". "),(0,l.kt)("p",null,"Here are some examples on how to define your own component types (often useful when interoping with existing JS code, or passing around components):"),(0,l.kt)("pre",null,(0,l.kt)("code",(0,a.Z)({parentName:"pre"},{className:"language-res"}),'// Plain function type\ntype friendComp =\n  ({"name": string, "online": bool}) => React.element;\n\n// Equivalent to\n// ({"padding": string, "children": React.element}) => React.element\ntype containerComp =\n  React.component<{\n    "padding": string,\n    "children": React.element\n  }>;\n')),(0,l.kt)("p",null,"The types above are pretty low level (basically the JS representation of a React component), but since ReScript React has its own ways of defining React components in a more language specific way, let's have a closer look on the anatomy of such a construct."),(0,l.kt)("h2",{id:"jsx-component-interface"},"JSX Component Interface"),(0,l.kt)("p",null,"A ReScript React component needs to be a (sub-)module with a ",(0,l.kt)("inlineCode",{parentName:"p"},"make")," and ",(0,l.kt)("inlineCode",{parentName:"p"},"makeProps")," function to be usable in JSX. To make things easier, we provide a ",(0,l.kt)("inlineCode",{parentName:"p"},"@react.component")," decorator to create those functions for you:"),(0,l.kt)(p,{labels:["Decorated","Expanded"],mdxType:"CodeTab"},(0,l.kt)("pre",null,(0,l.kt)("code",(0,a.Z)({parentName:"pre"},{className:"language-res"}),"module Friend = {\n  @react.component\n  let make = (~name: string, ~children) => {\n    <div>\n      {React.string(name)}\n      children\n    </div>\n  }\n}\n")),(0,l.kt)("pre",null,(0,l.kt)("code",(0,a.Z)({parentName:"pre"},{className:"language-res"}),'module Friend = {\n  @obj\n  external makeProps: (\n    ~name: string,\n    ~children: \'children,\n    ~key: string=?,\n    unit) => {. "name": string, "children": \'children\'} = "";\n\n  let make = (props: {. "name": string, "children": \'children}) => {\n    // React element creation from the original make function\n  }\n}\n'))),(0,l.kt)("p",null,"In the expanded output:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"makeProps"),": A function that receives multiple labeled arguments (according to prop names) and returns the value that is consumed by make(props)"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"make"),": A converted ",(0,l.kt)("inlineCode",{parentName:"li"},"make")," function that complies to the component interface ",(0,l.kt)("inlineCode",{parentName:"li"},"(props) => React.element"))),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"Note:")," The ",(0,l.kt)("inlineCode",{parentName:"p"},"makeProps")," function will also always contain a ",(0,l.kt)("inlineCode",{parentName:"p"},"~key")," prop."),(0,l.kt)("h3",{id:"special-case-reactforwardref"},"Special Case React.forwardRef"),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"@react.component")," decorator also works for ",(0,l.kt)("inlineCode",{parentName:"p"},"React.forwardRef")," calls:"),(0,l.kt)(p,{labels:["Decorated","Expanded"],mdxType:"CodeTab"},(0,l.kt)("pre",null,(0,l.kt)("code",(0,a.Z)({parentName:"pre"},{className:"language-res"}),"module FancyInput = {\n  @react.component\n  let make = React.forwardRef((~className=?, ~children, ref_) =>\n    <div>\n      // use ref_ here\n    </div>\n  )\n}\n")),(0,l.kt)("pre",null,(0,l.kt)("code",(0,a.Z)({parentName:"pre"},{className:"language-res"}),'// Simplified Output\nmodule FancyInput = {\n  @obj\n  external makeProps: (\n    ~className: \'className=?,\n    ~children: \'children,\n    ~key: string=?,\n    ~ref: \'ref=?,\n    unit,\n  ) => {"className": option<\'className>, "children": \'children} = ""\n\n  let make =\n    (~className=?, ~children) => ref_ => ReactDOMRe.createDOMElementVariadic("div", [])\n\n  let make = React.forwardRef(\n    (props: {"className": option<\'className>, "children": \'children}, ref_,) => {\n      make(\n        ~className=props["className"],\n        ~children=props["children"],\n        ref_)\n    })\n}\n'))),(0,l.kt)("p",null,"As shown in the expanded output above, our decorator desugars the function passed to ",(0,l.kt)("inlineCode",{parentName:"p"},"React.forwardRef")," in the same manner as a typical component ",(0,l.kt)("inlineCode",{parentName:"p"},"make")," function. It also creates a ",(0,l.kt)("inlineCode",{parentName:"p"},"makeProps")," function with a ",(0,l.kt)("inlineCode",{parentName:"p"},"ref")," prop, so we can use it in our JSX call (",(0,l.kt)("inlineCode",{parentName:"p"},"<FancyInput ref=.../>"),")."),(0,l.kt)("p",null,"So now that we know how the ReScript React component transformation works, let's have a look on how ReScript transforms our JSX constructs."),(0,l.kt)("h2",{id:"jsx-under-the-hood"},"JSX Under the Hood"),(0,l.kt)("p",null,'Whenever we are using JSX with a custom component ("capitalized JSX"), we are actually using ',(0,l.kt)("inlineCode",{parentName:"p"},"React.createElement")," to create a new element. Here is an example of a React component without children: "),(0,l.kt)(p,{labels:["JSX","Without JSX"],mdxType:"CodeTab"},(0,l.kt)("pre",null,(0,l.kt)("code",(0,a.Z)({parentName:"pre"},{className:"language-res"}),'<Friend name="Fred" age=1 />\n')),(0,l.kt)("pre",null,(0,l.kt)("code",(0,a.Z)({parentName:"pre"},{className:"language-res"}),'React.createElement(Friend.make, Friend.makeProps(~name="Fred", ~age=1, ()))\n')),(0,l.kt)("pre",null,(0,l.kt)("code",(0,a.Z)({parentName:"pre"},{className:"language-js"}),'React.createElement(Playground$Friend, { name: "Fred", age: 20 });\n'))),(0,l.kt)("p",null,"As you can see, it uses ",(0,l.kt)("inlineCode",{parentName:"p"},"Friend.make")," and ",(0,l.kt)("inlineCode",{parentName:"p"},"Friend.makeProps")," to call the ",(0,l.kt)("inlineCode",{parentName:"p"},"React.createElement")," API. In case you are providing children, it will use ",(0,l.kt)("inlineCode",{parentName:"p"},"React.createElementVariadic")," instead (which is just a different binding for ",(0,l.kt)("inlineCode",{parentName:"p"},"React.createElement"),"):"),(0,l.kt)(p,{labels:["JSX","Without JSX","JS Output"],mdxType:"CodeTab"},(0,l.kt)("pre",null,(0,l.kt)("code",(0,a.Z)({parentName:"pre"},{className:"language-res"}),'<Container width=200>\n  {React.string("Hello")}\n  {React.string("World")}\n</Container>\n')),(0,l.kt)("pre",null,(0,l.kt)("code",(0,a.Z)({parentName:"pre"},{className:"language-res"}),'React.createElementVariadic(\n  Container.make,\n  Container.makeProps(~width=200, ~children=React.null, ()),\n  [{React.string("Hello")}, {React.string("World")}],\n)\n')),(0,l.kt)("pre",null,(0,l.kt)("code",(0,a.Z)({parentName:"pre"},{className:"language-js"}),'React.createElement(Container, { width: 200, children: null }, "Hello", "World");\n'))),(0,l.kt)("p",null,"Note that the ",(0,l.kt)("inlineCode",{parentName:"p"},"~children=React.null")," prop has no relevance since React will only care about the children array passed as a third argument."),(0,l.kt)("h3",{id:"dom-elements"},"Dom Elements"),(0,l.kt)("p",null,'"Uncapitalized JSX" expressions are treated as DOM elements and will be converted to ',(0,l.kt)("inlineCode",{parentName:"p"},"ReactDOMRe.createDOMElementVariadic")," calls: "),(0,l.kt)(p,{labels:["JSX","Without JSX","JS Output"],mdxType:"CodeTab"},(0,l.kt)("pre",null,(0,l.kt)("code",(0,a.Z)({parentName:"pre"},{className:"language-res"}),'<div title="test"/>\n')),(0,l.kt)("pre",null,(0,l.kt)("code",(0,a.Z)({parentName:"pre"},{className:"language-res"}),'ReactDOMRe.createDOMElementVariadic("div", ~props=ReactDOMRe.domProps(~title="test", ()), [])\n')),(0,l.kt)("pre",null,(0,l.kt)("code",(0,a.Z)({parentName:"pre"},{className:"language-js"}),' React.createElement("div", { title: "test" });\n'))),(0,l.kt)("p",null,"The same goes for uncapitalized JSX with children:"),(0,l.kt)(p,{labels:["JSX","Without JSX","JS Output"],mdxType:"CodeTab"},(0,l.kt)("pre",null,(0,l.kt)("code",(0,a.Z)({parentName:"pre"},{className:"language-res"}),'<div title="test">\n  <span/>\n</div>\n')),(0,l.kt)("pre",null,(0,l.kt)("code",(0,a.Z)({parentName:"pre"},{className:"language-res"}),'ReactDOMRe.createDOMElementVariadic(\n  "div",\n  ~props=ReactDOMRe.domProps(~title="test", ()),\n  [ReactDOMRe.createDOMElementVariadic("span", [])],\n)\n')),(0,l.kt)("pre",null,(0,l.kt)("code",(0,a.Z)({parentName:"pre"},{className:"language-js"}),'React.createElement("div", { title: "test" }, React.createElement("span", undefined));\n'))))}d.isMDXComponent=!0,d.frontmatter={title:"Beyond JSX",description:"Details on how to use ReScript and React without JSX",canonical:"/docs/react/latest/beyond-jsx",__ghEditHref:"https://github.com/reason-association/rescript-lang.org/blob/master/pages/docs/react/latest/beyond-jsx.mdx"}},60091:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/docs/react/latest/beyond-jsx",function(){return t(50151)}])}},function(e){e.O(0,[49774],(function(){return n=60091,e(e.s=n);var n}));var n=e.O();_N_E=n}]);