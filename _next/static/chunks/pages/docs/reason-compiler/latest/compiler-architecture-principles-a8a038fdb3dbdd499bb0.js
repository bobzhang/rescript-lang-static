(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[48794],{22122:function(e,t,n){"use strict";function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}n.d(t,{Z:function(){return r}})},17375:function(e,t,n){"use strict";function r(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}n.d(t,{Z:function(){return r}})},3905:function(e,t,n){"use strict";n.d(t,{Zo:function(){return p},kt:function(){return f}});var r=n(67294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var s=r.createContext({}),l=function(e){var t=r.useContext(s),n=t;return e&&(n="function"===typeof e?e(t):o(o({},t),e)),n},p=function(e){var t=l(e.components);return r.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,i=e.mdxType,a=e.originalType,s=e.parentName,p=c(e,["components","mdxType","originalType","parentName"]),m=l(n),f=i,h=m["".concat(s,".").concat(f)]||m[f]||u[f]||a;return n?r.createElement(h,o(o({ref:t},p),{},{components:n})):r.createElement(h,o({ref:t},p))}));function f(e,t){var n=arguments,i=t&&t.mdxType;if("string"===typeof e||i){var a=n.length,o=new Array(a);o[0]=m;var c={};for(var s in t)hasOwnProperty.call(t,s)&&(c[s]=t[s]);c.originalType=e,c.mdxType="string"===typeof e?e:i,o[1]=c;for(var l=2;l<a;l++)o[l]=n[l];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},96086:function(e){"use strict";var t=Object.assign.bind(Object);e.exports=t,e.exports.default=e.exports},5870:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return s}});var r=n(22122),i=n(17375),a=n(67294),o=n(3905),c=(a.createElement,{});function s(e){var t=e.components,n=(0,i.Z)(e,["components"]);return(0,o.kt)("wrapper",(0,r.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"compiler-architecture"},"Compiler Architecture"),(0,o.kt)("p",null,"ReScript's high level architecture:"),(0,o.kt)("pre",null,(0,o.kt)("code",(0,r.Z)({parentName:"pre"},{}),"Source Language\n  |\n  | (Reuse OCaml Parser)\n  v\nSurface Syntax Tree\n  |\n  | (built in Syntax tree transformation)\n  v\nSurface Syntax Tree\n  |\n  | (Reuse OCaml Type checker)\n  v\nTypedtree\n  |\n  | (Reuse OCaml pattern match compiler and erase types)\n  | (Patches to pass more information down to Lambda )\n  |\nOCaml Lambda IR\n  |\n  |\n  v\nBuckle Lambda IR ------------------+\n  |   ^                            |\n  |   |                     6 Lambda Passes (lam_* files)\n  |   |             Optimization/inlining/dead code elimination\n  |   \\                            |\n  |    \\ --------------------------+\n  |\n  |  Self tail call elimination\n  |  Constant folding + propagation\n  V\nJS IR (J.ml)  ---------------------+\n  |   ^                            |\n  |   |                     6 JS Passes (js_* files)\n  |   |            Optimization/inlining/dead code elimination\n  |   \\                            |\n  |    \\  -------------------------+\n  |\n  |  Smart printer includes scope analysis\n  |\n  V\nJavascript Code\n")),(0,o.kt)("h2",{id:"design-decisions"},"Design Decisions"),(0,o.kt)("p",null,"The design of ReScript follows several high-level principles. While those principles might change in the future, they are enforced today and can explain certain technical limitations BS has."),(0,o.kt)("h3",{id:"lambda-representation"},"Lambda Representation"),(0,o.kt)("p",null,"As pictured in the diagram above, ReScript is primarily based on the Lambda representation of the OCaml compiler. While this representation is quite rich, some information is lost from the upstream representation. The patch to the OCaml compiler tries to enrich this representation in a non-intrusive way (see next section)."),(0,o.kt)("h3",{id:"minimal-patch-to-the-ocaml-compiler"},"Minimal Patch to the OCaml compiler"),(0,o.kt)("p",null,"ReScript requires patches to the OCaml compiler. One of the main reasons is to enrich the Lambda representation so that the generated code is as nice as possible. A design goal is to keep those patches minimal and useful for the OCaml compiler in general so that they can later be integrated."),(0,o.kt)("h3",{id:"soundness"},"Soundness"),(0,o.kt)("p",null,"ReScript preserves the soundness of the OCaml language. Assuming the FFI is correctly implemented, the type safety is preserved."),(0,o.kt)("h3",{id:"minimal-new-symbol-creation"},"Minimal new symbol creation"),(0,o.kt)("p",null,"In order to make the JavaScript generated code as close as possible to the original OCaml core we thrive to introduce as few new symbols as possible."))}s.isMDXComponent=!0,s.frontmatter={__ghEditHref:"https://github.com/reason-association/rescript-lang.org/blob/master/pages/docs/reason-compiler/latest/compiler-architecture-principles.mdx"}},1763:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/docs/reason-compiler/latest/compiler-architecture-principles",function(){return n(5870)}])}},function(e){e.O(0,[49774],(function(){return t=1763,e(e.s=t);var t}));var t=e.O();_N_E=t}]);