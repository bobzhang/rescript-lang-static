(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[61405],{17375:function(e,t,n){"use strict";function a(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},l=Object.keys(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}n.d(t,{Z:function(){return a}})},92873:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return i}});var a=n(96156),o=n(17375),l=(n(67294),n(3905));function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var r={};function i(e){var t=e.components,n=(0,o.Z)(e,["components"]);return(0,l.kt)("wrapper",p(p(p({},r),n),{},{components:t,mdxType:"MDXLayout"}),(0,l.kt)("h1",p({},{id:"extended-compiler-options"}),"Extended Compiler Options"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"Note"),": this section is only for people who want roll their own build system instead of using the recommended build system, ",(0,l.kt)("inlineCode",{parentName:"p"},"bsb"),". This also provides some tips for contributors who debug the compiler."),(0,l.kt)("p",null,"ReScript inherits the command line arguments of the ",(0,l.kt)("a",p({parentName:"p"},{href:"http://caml.inria.fr/pub/docs/manual-ocaml/comp.html"}),"OCaml compiler"),". It also adds several BS-specific flags. Run ",(0,l.kt)("inlineCode",{parentName:"p"},"bsc -help")," to see the list."),(0,l.kt)("p",null,"All these flags can be passed into the ",(0,l.kt)("inlineCode",{parentName:"p"},"bsc-flags")," section of ",(0,l.kt)("inlineCode",{parentName:"p"},"bsb")," (though some of them don't make sense to be passed)."),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"Note")," also that this section isn't kept very up-to-date. Contributions welcome!"),(0,l.kt)("h2",p({},{id:"-bs-main-single-directory-build"}),"-bs-main (single directory build)"),(0,l.kt)("pre",null,(0,l.kt)("code",p({parentName:"pre"},{className:"language-sh"}),"bsc -bs-main Main\n")),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"bsc")," will build module ",(0,l.kt)("inlineCode",{parentName:"p"},"Main")," and all its dependencies. When it finishes, it'll run ",(0,l.kt)("inlineCode",{parentName:"p"},"node main.js"),"."),(0,l.kt)("pre",null,(0,l.kt)("code",p({parentName:"pre"},{className:"language-sh"}),"bsc -c -bs-main Main\n")),(0,l.kt)("p",null,"Same as above, but will not run ",(0,l.kt)("inlineCode",{parentName:"p"},"node"),"."),(0,l.kt)("h2",p({},{id:"-bs-files"}),"-bs-files"),(0,l.kt)("p",null,"So that you can do"),(0,l.kt)("pre",null,(0,l.kt)("code",p({parentName:"pre"},{className:"language-sh"}),"bsc -c -bs-files *.ml *.mli\n")),(0,l.kt)("p",null,"the compiler will sort the order of input files before starting compilation."),(0,l.kt)("p",null,"ReScript supports two compilation modes: script mode and package mode. In package mode, you have to provide ",(0,l.kt)("inlineCode",{parentName:"p"},"package.json")," on top and set the options ",(0,l.kt)("inlineCode",{parentName:"p"},"-bs-package-name"),", ",(0,l.kt)("inlineCode",{parentName:"p"},"-bs-package-output"),". In script mode, such flags are not needed."),(0,l.kt)("h2",p({},{id:"-bs-package-name"}),"-bs-package-name"),(0,l.kt)("p",null,"The name of your project. It's recommended to use the same ",(0,l.kt)("inlineCode",{parentName:"p"},"name")," than the one in ",(0,l.kt)("inlineCode",{parentName:"p"},"package.json"),"."),(0,l.kt)("h2",p({},{id:"-bs-package-output"}),"-bs-package-output"),(0,l.kt)("p",null,"Configure the output module system. The format is ",(0,l.kt)("inlineCode",{parentName:"p"},"module_system:output/path/relative/to/package.json"),"."),(0,l.kt)("p",null,"Currently supported systesms are: ",(0,l.kt)("inlineCode",{parentName:"p"},"commonjs"),", ",(0,l.kt)("inlineCode",{parentName:"p"},"amdjs")," and ",(0,l.kt)("inlineCode",{parentName:"p"},"es6"),"."),(0,l.kt)("p",null,"For example, when you want to use the ",(0,l.kt)("inlineCode",{parentName:"p"},"es6")," module system:"),(0,l.kt)("pre",null,(0,l.kt)("code",p({parentName:"pre"},{className:"language-sh"}),"bsc -bs-package-name your_package -bs-package-output es6:lib/es6 -c xx.ml\n")),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"Note"),": you can supply multiple ",(0,l.kt)("inlineCode",{parentName:"p"},"-bs-package-output")," at once. For example:"),(0,l.kt)("pre",null,(0,l.kt)("code",p({parentName:"pre"},{className:"language-sh"}),"bsc -bs-package-name name -bs-package-output commonjs:lib/js  -bs-package-output amdjs:lib/amdjs -c x.ml\n")),(0,l.kt)("p",null,"It'll generate ",(0,l.kt)("inlineCode",{parentName:"p"},"x.js")," in ",(0,l.kt)("inlineCode",{parentName:"p"},"lib/js")," as a commonjs module, ",(0,l.kt)("inlineCode",{parentName:"p"},"lib/amdjs")," as an amdjs module at the same time."),(0,l.kt)("p",null,"You would then need a bundler for the different module systems: webpack supports ",(0,l.kt)("inlineCode",{parentName:"p"},"commonjs")," and ",(0,l.kt)("inlineCode",{parentName:"p"},"amdjs"),", rollup supports es6, while google closure compiler supports all."),(0,l.kt)("h2",p({},{id:"-bs-no-warn-ffi-type"}),"-bs-no-warn-ffi-type"),(0,l.kt)("p",null,"Turn off warnings on FFI type declarations."),(0,l.kt)("h2",p({},{id:"-bs-eval"}),"-bs-eval"),(0,l.kt)("p",null,"Example:"),(0,l.kt)("pre",null,(0,l.kt)("code",p({parentName:"pre"},{className:"language-sh"}),'> bsc -dparsetree -drawlambda -bs-eval \'Js.log "hello"\'\n\n[\n  structure_item (//toplevel//[1,0+0]..[1,0+14])\n    Pstr_eval\n    expression (//toplevel//[1,0+0]..[1,0+14])\n      Pexp_apply\n      expression (//toplevel//[1,0+0]..[1,0+6])\n        Pexp_ident "Js.log" (//toplevel//[1,0+0]..[1,0+6])\n      [\n        <label> ""\n          expression (//toplevel//[1,0+7]..[1,0+14])\n            Pexp_constant Const_string("hello",None)\n      ]\n]\n\n(setglobal Bs_internal_eval! (seq (log "hello") (makeblock 0)))\n// Generated by ReScript VERSION 2.1.0, PLEASE EDIT WITH CARE\n\'use strict\';\n\n\nconsole.log("hello");\n\n/*  Not a pure module */\n')),(0,l.kt)("p",null,"In conjunction with ",(0,l.kt)("inlineCode",{parentName:"p"},"-bs-eval"),": the first block is the output of ",(0,l.kt)("inlineCode",{parentName:"p"},"-dparsetree"),", the second is from ",(0,l.kt)("inlineCode",{parentName:"p"},"-drawlambda"),"."),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"-bs-eval")," doesn't create intermediate file. Useful for learning or troubleshooting."),(0,l.kt)("h2",p({},{id:"-bs-no-builtin-ppx-ml--bs-no-builtin-ppx-mli"}),"-bs-no-builtin-ppx-ml, -bs-no-builtin-ppx-mli"),(0,l.kt)("p",null,"If you don't use any BS-specific annotations, you can explicitly turn it off. Another use-case is to use ",(0,l.kt)("inlineCode",{parentName:"p"},"-ppx")," explicitly as below:"),(0,l.kt)("pre",null,(0,l.kt)("code",p({parentName:"pre"},{className:"language-sh"}),"bsc -c -ppx bsppx.exe -bs-no-builtin-ppx-ml c.ml\n")),(0,l.kt)("h2",p({},{id:"-bs-no-version-header"}),"-bs-no-version-header"),(0,l.kt)("p",null,"Don\u2019t print BS version at the beginning of each JS file."),(0,l.kt)("h2",p({},{id:"-bs-g-experimental-since-310"}),"-bs-g (Experimental, since @3.1.0)"),(0,l.kt)("p",null,"See ",(0,l.kt)("a",p({parentName:"p"},{href:"./better-data-structures-printing-debug-mode.md"}),"Better Data Structures Printing (Debug Mode)"),"."))}i.isMDXComponent=!0,i.frontmatter={__ghEditHref:"https://github.com/reason-association/rescript-lang.org/blob/master/pages/docs/reason-compiler/latest/extended-compiler-options.mdx"}},59767:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/docs/reason-compiler/latest/extended-compiler-options",function(){return n(92873)}])}},function(e){e.O(0,[92888,49774,40179],(function(){return t=59767,e(e.s=t);var t}));var t=e.O();_N_E=t}]);