(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[95016],{17375:function(e,n,t){"use strict";function o(e,n){if(null==e)return{};var t,o,r=function(e,n){if(null==e)return{};var t,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)t=i[o],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)t=i[o],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}t.d(n,{Z:function(){return o}})},20749:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return u}});var o=t(17375),r=t(96156),i=(t(67294),t(3905));function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){(0,r.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var s,p=(s="CodeTab",function(e){return console.warn("Component "+s+" was not imported, exported, or provided by MDXProvider as global scope"),(0,i.kt)("div",l({},e))}),c={};function u(e){var n=e.components,t=(0,o.Z)(e,["components"]);return(0,i.kt)("wrapper",l(l(l({},c),t),{},{components:n,mdxType:"MDXLayout"}),(0,i.kt)("h1",l({},{id:"inlining-constants"}),"Inlining Constants"),(0,i.kt)("p",null,"Sometime, in the JavaScript output, you might want a certain value to be forcefully inlined. For example:"),(0,i.kt)("pre",null,(0,i.kt)("code",l({parentName:"pre"},{className:"language-js"}),"if (process.env.mode === 'development') {\n  console.log(\"Dev-only code here!\")\n}\n")),(0,i.kt)("p",null,"The reason is that your JavaScript bundler (e.g. Webpack) might turn that into:"),(0,i.kt)("pre",null,(0,i.kt)("code",l({parentName:"pre"},{className:"language-js"}),"if ('production' === 'development') {\n  console.log(\"Dev-only code here!\")\n}\n")),(0,i.kt)("p",null,"Then your subsequent Uglifyjs optimization would remove that entire ",(0,i.kt)("inlineCode",{parentName:"p"},"if")," block. This is how projects like ReactJS provide a development mode code with plenty of dev warnings, while ensuring that the uglified (minified) production code is free of those expensive blocks."),(0,i.kt)("p",null,"So, in ReScript, producing that example ",(0,i.kt)("inlineCode",{parentName:"p"},"if (process.env.mode === 'development')")," output is important. This first try doesn't work:"),(0,i.kt)(p,{labels:["ReScript","JS Output"],mdxType:"CodeTab"},(0,i.kt)("pre",null,(0,i.kt)("code",l({parentName:"pre"},{className:"language-res",metastring:"example",example:!0}),'@val external process: \'a = "process"\n\nlet mode = "development"\n\nif (process["env"]["mode"] === mode) {\n  Js.log("Dev-only code here!")\n}\n')),(0,i.kt)("pre",null,(0,i.kt)("code",l({parentName:"pre"},{className:"language-js"}),'var mode = "development";\n\nif (process.env.mode === mode) {\n  console.log("Dev-only code here!");\n}\n'))),(0,i.kt)("p",null,"The JS output shows ",(0,i.kt)("inlineCode",{parentName:"p"},"if (process.env.mode === mode)"),", which isn't what we wanted. To inline ",(0,i.kt)("inlineCode",{parentName:"p"},"mode"),"'s value, use ",(0,i.kt)("inlineCode",{parentName:"p"},"@inline"),":"),(0,i.kt)(p,{labels:["ReScript","JS Output"],mdxType:"CodeTab"},(0,i.kt)("pre",null,(0,i.kt)("code",l({parentName:"pre"},{className:"language-res",metastring:"example",example:!0}),'@val external process: \'a = "process"\n\n@inline\nlet mode = "development"\n\nif (process["env"]["mode"] === mode) {\n  Js.log("Dev-only code here!")\n}\n')),(0,i.kt)("pre",null,(0,i.kt)("code",l({parentName:"pre"},{className:"language-js"}),'if (process.env.mode === "development") {\n  console.log("Dev-only code here!");\n}\n'))),(0,i.kt)("p",null,"Now your resulting JS code can pass through Webpack and Uglifyjs like the rest of your JavaScript code, and that whole ",(0,i.kt)("inlineCode",{parentName:"p"},"console.log")," can be removed."),(0,i.kt)("p",null,"The inlining currently only works for ",(0,i.kt)("strong",{parentName:"p"},"string, float and boolean"),"."),(0,i.kt)("h2",l({},{id:"tips--tricks"}),"Tips & Tricks"),(0,i.kt)("p",null,"This is ",(0,i.kt)("strong",{parentName:"p"},"not")," an optimization. This is an edge-case feature for folks who absolutely need particular values inlined for a JavaScript post-processing step, like conditional compilation. Beside the difference in code that the conditional compilation might end up outputting, there's no performance difference between inlining and not inlining simple values in the eyes of a JavaScript engine."))}u.isMDXComponent=!0,u.frontmatter={title:"Inlining Constants",description:"Inlining constants",canonical:"/docs/manual/latest/inlining-constants",__ghEditHref:"https://github.com/reason-association/rescript-lang.org/blob/master/pages/docs/manual/v9.0.0/inlining-constants.mdx"}},11821:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/docs/manual/v9.0.0/inlining-constants",function(){return t(20749)}])}},function(e){e.O(0,[92888,49774,40179],(function(){return n=11821,e(e.s=n);var n}));var n=e.O();_N_E=n}]);